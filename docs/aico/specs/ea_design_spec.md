# AICO_EA架构设计规范

## 1. 文档结构标准
```text
1. 版本控制（表格）
2. 业务架构（BA）
   2.1 战略目标（JSON）
   2.2 核心业务流程（Mermaid）
   2.3 用户故事地图（表格）
3. 应用架构（AA）
   3.1 系统组成（PlantUML）
   3.2 服务接口规范（JSON）
4. 数据架构（DA） 
   4.1 核心数据模型（Mermaid ER图）
   4.2 数据流向（伪代码）
5. 技术架构（TA）
   5.1 基础设施（Bash命令）
   5.2 技术选型（表格）
6. 架构演进路线（时间线+列表）
```

## 2. 内容规范

### 2.1 业务架构（BA）
```markdown
必须包含：
- 战略目标：JSON格式，包含vision和goals字段
- 业务流程：Mermaid流程图，使用graph TD语法
- 用户故事：表格包含故事ID、需求来源、业务流程、验收标准
禁止：
- 使用自然语言描述流程（必须可视化）
- 混入技术实现细节
```

### 2.2 应用架构（AA）
```markdown
必须包含：
- 系统组成：Mermaid组件图（@startuml...@enduml）
- 接口规范：JSON格式，包含endpoint/method/response
推荐：
- 每个微服务对应一个组件
- 接口版本号遵循vX.Y格式
```

### 2.3 数据架构（DA)
```markdown
必须包含：
- ER图：Mermaid语法，使用erDiagram类型
- 数据流向：Python伪代码（带时间频率注释）
禁止：
- 使用非标准图表类型
- 暴露真实数据库配置
```

### 2.4 技术架构（TA）
```markdown
必须包含：
- 部署命令：Docker或K8s的Bash命令
- 技术选型：2列表格（领域+技术栈）
推荐：
- 基础设施部分包含监控方案
- 标注技术栈版本号（如Spring Boot 3.1.2）
```

## 3. 版本管理规范
```markdown
版本表必须包含：
| 版本 | 日期（YYYY-MM-DD） | 生成角色（BA/EA） | 变更说明 |

更新规则：
1. 业务架构变更：次版本号+1（1.1→1.2）
2. 技术架构变更：主版本号+1（1.2→2.0）
3. 紧急修复：追加字母后缀（1.2a）
```

## 4. 关联性要求
```markdown
必须建立以下关联：
1. 用户故事 → 需求ID（REQ-XXX）
2. 接口规范 → 应用组件 
3. 数据模型 → ER图实体
4. 技术选型 → 基础设施命令

关联方式：
- 使用脚注标记：商品查询接口<sup>[AA-2.1]</sup>
- 表格字段关联：在"需求来源"字段填写REQ-ID
```

## 5. 自动化标记规则
```python
# 自动生成内容需添加标记
def generate_section():
    """[AUTO-GEN] 该章节由BA系统自动生成，最后更新于2024-01-20"""
    
# 人工修改需添加注释
## 核心业务流程 (人工修订于2024-01-21)
```

## 6. 安全规范
```markdown
1. 架构图中不得出现真实IP/域名
2. 密码类配置需用${VAR}占位符
3. 访问控制策略需独立章节说明
4. 加密算法需标注版本（如TLS 1.3）
```

## 7. 格式检查清单
```text
[√] 所有图表可正常渲染
[√] JSON格式通过验证器检查  
[√] 版本号符合语义化规范
[√] 无敏感信息泄露
[√] 变更说明与版本号匹配
[√] 角色标注完整（BA/EA）
```

